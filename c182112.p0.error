/workspace/miniconda3/envs/med/lib/python3.11/site-packages/transformers/utils/hub.py:127: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2024-08-14 03:05:08.707615: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
wandb: Appending key for api.wandb.ai to your netrc file: /user/HS401/ra01888/.netrc
wandb: Currently logged in as: rozadler-rd (rozadler-rd-university-of-surrey). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.6
wandb: Run data is saved locally in /scratch/condor/dir_3501231/wandb/run-20240814_030512-hg72u50n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pneumoniamnist, vit_timm, epochs 5, BS 64, LR 0.0001
wandb: ‚≠êÔ∏è View project at https://wandb.ai/rozadler-rd-university-of-surrey/medMnist-experiments
wandb: üöÄ View run at https://wandb.ai/rozadler-rd-university-of-surrey/medMnist-experiments/runs/hg72u50n
INFO:timm.models._builder:Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
INFO:timm.models._hub:[timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
INFO:timm.models._builder:Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
  0%|          | 0/5 [00:00<?, ?it/s]
Evaluating:   0%|          | 0/9 [00:00<?, ?it/s][A
Evaluating:  11%|‚ñà         | 1/9 [00:00<00:02,  3.86it/s][A
Evaluating:  22%|‚ñà‚ñà‚ñè       | 2/9 [00:00<00:01,  3.93it/s][A
Evaluating:  33%|‚ñà‚ñà‚ñà‚ñé      | 3/9 [00:00<00:01,  3.97it/s][A
Evaluating:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 4/9 [00:01<00:01,  3.92it/s][A
Evaluating:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 5/9 [00:01<00:01,  3.95it/s][A
Evaluating:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 6/9 [00:01<00:00,  3.95it/s][A
Evaluating:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 7/9 [00:01<00:00,  3.97it/s][A
Evaluating:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 8/9 [00:02<00:00,  3.98it/s][A
                                                         [A 20%|‚ñà‚ñà        | 1/5 [00:55<03:40, 55.08s/it]
Evaluating:   0%|          | 0/9 [00:00<?, ?it/s][A
Evaluating:  11%|‚ñà         | 1/9 [00:00<00:01,  4.10it/s][A
Evaluating:  22%|‚ñà‚ñà‚ñè       | 2/9 [00:00<00:01,  4.08it/s][A
Evaluating:  33%|‚ñà‚ñà‚ñà‚ñé      | 3/9 [00:00<00:01,  4.08it/s][A
Evaluating:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 4/9 [00:00<00:01,  4.07it/s][A
Evaluating:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 5/9 [00:01<00:00,  4.07it/s][A
Evaluating:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 6/9 [00:01<00:00,  4.04it/s][A
Evaluating:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 7/9 [00:01<00:00,  4.02it/s][A
Evaluating:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 8/9 [00:01<00:00,  4.01it/s][A
                                                         [A 40%|‚ñà‚ñà‚ñà‚ñà      | 2/5 [01:51<02:47, 55.67s/it]
Evaluating:   0%|          | 0/9 [00:00<?, ?it/s][A
Evaluating:  11%|‚ñà         | 1/9 [00:00<00:01,  4.09it/s][A
Evaluating:  22%|‚ñà‚ñà‚ñè       | 2/9 [00:00<00:01,  4.08it/s][A
Evaluating:  33%|‚ñà‚ñà‚ñà‚ñé      | 3/9 [00:00<00:01,  4.04it/s][A
Evaluating:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 4/9 [00:00<00:01,  4.02it/s][A
Evaluating:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 5/9 [00:01<00:00,  4.01it/s][A
Evaluating:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 6/9 [00:01<00:00,  4.00it/s][A
Evaluating:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 7/9 [00:01<00:00,  4.00it/s][A
Evaluating:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 8/9 [00:01<00:00,  3.99it/s][A
                                                         [A 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 3/5 [02:47<01:51, 55.77s/it]
Evaluating:   0%|          | 0/9 [00:00<?, ?it/s][A
Evaluating:  11%|‚ñà         | 1/9 [00:00<00:01,  4.01it/s][A
Evaluating:  22%|‚ñà‚ñà‚ñè       | 2/9 [00:00<00:01,  3.99it/s][A
Evaluating:  33%|‚ñà‚ñà‚ñà‚ñé      | 3/9 [00:00<00:01,  4.00it/s][A
Evaluating:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 4/9 [00:01<00:01,  3.99it/s][A
Evaluating:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 5/9 [00:01<00:01,  4.00it/s][A
Evaluating:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 6/9 [00:01<00:00,  4.00it/s][A
Evaluating:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 7/9 [00:01<00:00,  3.99it/s][A
Evaluating:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 8/9 [00:02<00:00,  3.99it/s][A
                                                         [A 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 4/5 [03:42<00:55, 55.55s/it]
Evaluating:   0%|          | 0/9 [00:00<?, ?it/s][A
Evaluating:  11%|‚ñà         | 1/9 [00:00<00:01,  4.03it/s][A
Evaluating:  22%|‚ñà‚ñà‚ñè       | 2/9 [00:00<00:01,  4.02it/s][A
Evaluating:  33%|‚ñà‚ñà‚ñà‚ñé      | 3/9 [00:00<00:01,  4.01it/s][A
Evaluating:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 4/9 [00:00<00:01,  4.00it/s][A
Evaluating:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 5/9 [00:01<00:00,  4.00it/s][A
Evaluating:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 6/9 [00:01<00:00,  3.99it/s][A
Evaluating:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 7/9 [00:01<00:00,  4.00it/s][A
Evaluating:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 8/9 [00:02<00:00,  3.99it/s][A
                                                         [A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5/5 [04:37<00:00, 55.44s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5/5 [04:37<00:00, 55.50s/it]
Evaluating:   0%|          | 0/10 [00:00<?, ?it/s]Evaluating:  10%|‚ñà         | 1/10 [00:00<00:02,  3.99it/s]Evaluating:  20%|‚ñà‚ñà        | 2/10 [00:00<00:02,  3.99it/s]Evaluating:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:00<00:01,  3.97it/s]Evaluating:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:01<00:01,  3.98it/s]Evaluating:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:01<00:01,  3.96it/s]Evaluating:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:01<00:01,  3.96it/s]Evaluating:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:01<00:00,  3.96it/s]Evaluating:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:02<00:00,  3.96it/s]Evaluating:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:02<00:00,  3.96it/s]Evaluating: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:02<00:00,  4.27it/s]                                                           Traceback (most recent call last):
  File "/scratch/condor/dir_3501231/medmnist/train_and_eval.py", line 180, in <module>
    main(args)
  File "/scratch/condor/dir_3501231/medmnist/train_and_eval.py", line 153, in main
    test_loss, test_auc, test_acc = evaluate(best_model, test_loader, criterion, test_evaluator, device, save_folder=args.output_dir, run='test')
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/condor/dir_3501231/medmnist/train_and_eval.py", line 59, in evaluate
    wandb.log({"val_loss": total_loss / len(dataloader.dataset), "val_auc": auc, "val_acc": acc, "epoch": epoch+1})
                                                                                                          ~~~~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
wandb: - 0.008 MB of 0.008 MB uploadedwandb: \ 0.008 MB of 0.016 MB uploadedwandb: | 0.008 MB of 0.016 MB uploadedwandb: / 0.008 MB of 0.016 MB uploadedwandb: - 0.008 MB of 0.016 MB uploadedwandb: \ 0.016 MB of 0.016 MB uploadedwandb: 
wandb: Run history:
wandb:      epoch ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñà‚ñà
wandb: train_loss ‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÅ
wandb:    val_acc ‚ñÖ‚ñà‚ñÅ‚ñÅ‚ñá
wandb:    val_auc ‚ñÅ‚ñÜ‚ñà‚ñá‚ñá
wandb:   val_loss ‚ñá‚ñÉ‚ñÅ‚ñà‚ñÉ
wandb: 
wandb: Run summary:
wandb:      epoch 5
wandb: train_loss 0.05856
wandb:    val_acc 0.9542
wandb:    val_auc 0.99623
wandb:   val_loss 0.10318
wandb: 
wandb: üöÄ View run pneumoniamnist, vit_timm, epochs 5, BS 64, LR 0.0001 at: https://wandb.ai/rozadler-rd-university-of-surrey/medMnist-experiments/runs/hg72u50n
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/rozadler-rd-university-of-surrey/medMnist-experiments
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240814_030512-hg72u50n/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
